import{r as n,u as w,a as r,j as a,b as e,g as N,B as f,F as C,d as L,k as b,c as S,e as x,R as E,f as H,h as R,i as y,l as A,m as P}from"./index-864a135d.js";import{S as I}from"./share-782b4de0.js";const M=t=>n.createElement("svg",{width:22,height:19,viewBox:"0 0 22 19",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},n.createElement("path",{d:"M1.11647 5.01331C0.12785 10.013 5.61648 14.5019 10.6257 18.0013C16 15.5001 21.9708 10.3932 20.5 5C19 -0.500115 13.5 0.500198 10.6257 3.51336C6.62141 -1.48632 1.70646 2.02961 1.11647 5.01331Z"}));const B=t=>n.createElement("svg",{width:28,height:30,viewBox:"0 0 28 30",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.22883 1.12323C1.66821 0.788335 2.2622 0.739403 2.75047 0.997888L26.8338 13.7479C27.2976 13.9934 27.5876 14.4752 27.5876 14.9999C27.5876 15.5247 27.2976 16.0065 26.8338 16.252L2.75047 29.002C2.2622 29.2604 1.66821 29.2115 1.22883 28.8766C0.789449 28.5417 0.584839 27.9818 0.704689 27.4427L3.46973 14.9999L0.704689 2.55724C0.584839 2.01793 0.789449 1.45815 1.22883 1.12323ZM6.05737 16.4166L4.13605 25.0625L20.4673 16.4166H6.05737ZM20.4673 13.5833H6.05737L4.13605 4.93734L20.4673 13.5833Z",fill:"#232323"}));const O=t=>n.createElement("svg",{width:17,height:17,viewBox:"0 0 17 17",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},n.createElement("path",{d:"M4.62294 7.05012V16M4.62294 7.05012L1 7.05011V16H4.62294M4.62294 7.05012L9.32879 1.62513C9.77531 1.11036 10.4778 0.889067 11.1435 1.0535L11.1865 1.06414C12.4019 1.36437 12.9493 2.76365 12.2545 3.79358L10.0574 7.05011H14.1879C15.331 7.05011 16.1884 8.08348 15.9642 9.19111L14.8773 14.561C14.708 15.3978 13.9645 16 13.101 16H4.62294",stroke:"white",strokeLinecap:"round",strokeLinejoin:"round"}));function T({user:t,text:d,createdAt:c,numsOfLike:h,id:o,thisUserIsLike:i}){const k=w(),s=r(l=>l.auth),m=r(l=>l.comments),v=()=>{k(L({commentid:o}))},_=()=>{k(b({commentid:o}))},u=()=>{if(m.yourLikedComments.length==0)return!1;let l=!1;for(let p=0;p<m.yourLikedComments.length;p++)m.yourLikedComments[p].commentId==o&&(l=!0);return l};return a("div",{className:"comments-item",children:[e("div",{className:"comments-item__useravatar",children:e("div",{style:{background:`url('${N.SERVER_HOST+"/"+t.avatar}')`,backgroundSize:"cover",backgroundPosition:"center"},className:"comments-item__useravatar-inside"})}),a("div",{className:"comments-item__header-info",children:[e("h2",{className:"comments-item__username",children:t.username}),e("p",{className:"comments-item__time",children:c})]}),e("p",{className:"comments-item__text",children:d}),e("div",{className:"comments-item__mark-bar",children:a("button",{className:u()?"comments-item__like comments-item__btn comments-item__btn_active":"comments-item__like comments-item__btn",onClick:_,children:[" ",e(O,{className:"comments-item__icon"}),e("p",{className:"comments-item__like-text",children:h})]})}),s.isAuth&&s.isAdmin?e("div",{className:"comments-item__del-btn",children:e(f,{type:"delete",onClick:v,children:e(C,{})})}):e(C,{children:s.isAuth&&s.userInfo.id==t.id?e("div",{className:"comments-item__del-btn",children:e(f,{type:"delete",onClick:v,children:e(C,{})})}):null})]})}function $(){const[t,d]=n.useState(""),c=w(),h=r(s=>s.auth),o=r(s=>s.posts),i=r(s=>s.comments);return n.useEffect(()=>{o.posts!=null&&c(S({postid:o.posts[0].id}))},[o,c]),n.useEffect(()=>{h.isAuth&&c(x())},[h.isAuth]),a("div",{className:"comments",children:[a("header",{className:"comments__header",children:[e("input",{className:"comments__input",placeholder:"Оставьте комментарий",value:t,onChange:s=>d(s.target.value)}),e(f,{onClick:()=>{if(t=="")return!1;if(!h.isAuth)return alert("Вы не можите оставлять комментарии, пока вы не авторизованы");o.posts!=null&&(c(H({postid:o.posts[0].id,text:t})),d(""))},className:"comments__button",children:e(B,{className:"comments__icon"})})]}),e("div",{className:"comments__body",children:i.comments.length!=0?e(C,{children:i.comments.map((s,m)=>e(E.Fragment,{children:e(T,{...s})},m))}):e("h1",{className:"error-text",children:"Комментариев нет"})})]})}function V(){n.useEffect(()=>{u(R({id:String(t)}))},[]);const{postId:t}=y(),[d,c]=n.useState(!1),[h,o]=n.useState(""),{posts:i,loading:k,success:s,error:m}=r(g=>g.posts),v=r(g=>g.auth),_=r(g=>g.likes),u=w();n.useEffect(()=>{m&&o(m),i&&t&&u(A({postid:t}))},[m,u,i]),n.useEffect(()=>{_.like&&c(_.like.like)},[_.like]);const l=()=>{c(!d),u(P({postid:String(t)}))};async function p(){N.FRONT_HOST+`/blog/${t}`,await navigator.clipboard.writeText("dsf")}return h!=null&&i!=null&&(i==null?void 0:i.length)!=0?a("div",{className:"post",children:[e("div",{className:"post__preview",style:{height:400,width:"100%",background:`url('${N.SERVER_HOST+"/"+i[0].preview}')`,backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundPosition:"center"}}),a("div",{className:"post__content",children:[e("h1",{className:"post__title",children:i[0].title}),e("p",{className:"post__text",children:i[0].content}),a("div",{className:"post__estimation",children:[_&&v.isAuth?e(f,{onClick:l,className:d?"post__estimation-btn post__estimation-btn_active":"post__estimation-btn",children:a("div",{className:"post__estimation-inside",children:[e(M,{className:"post__estimation-icon"}),e("p",{className:"post__estimation-text",children:"Понравилось"})]})}):null,e(f,{onClick:()=>p(),className:"post__estimation-btn",children:e("div",{className:"post__estimation-inside",children:e(I,{})})})]}),e("div",{className:"post__comments",children:e($,{})})]})]}):a("h1",{className:"error-text",children:[m," error"]})}export{V as default};
