import{y as f,u as N,a as h,r as m,j as t,F as d,b as e,g as y,B as u,M as B,z as x,n as O,R as P}from"./index-864a135d.js";import{A as R}from"./AdminMenu-89a6688f.js";import{I as w}from"./ImageViewer-6bea9138.js";function E({title:s,createdAt:a,content:l,preview:o,id:n,index:i}){const v=f(),k=N(),A=h(r=>r.posts),[p,_]=m.useState(),g=(r,S)=>{S?(_(null),document.body.style.overflow="auto"):_(r)},C=l.slice(0,400)+"...",[b,c]=m.useState(!1),I=()=>{n!=null&&k(x({postid:n}))};return t(d,{children:[t("div",{className:"blogitem",children:[e("div",{className:"blogitem__preview",style:{background:`url('${y.SERVER_HOST+"/"+o}')`,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover"},onClick:()=>g(n,!1)}),t("div",{className:"blogitem__info",children:[e("h1",{className:"blogitem__title",children:s}),t("p",{className:"blogitem__date",children:["Опубликовано: ",a]}),e("p",{className:"blogitem__text",children:C})]}),t("div",{className:"blogitem__tools",children:[e(u,{type:"delete",onClick:()=>c(!0),children:e(d,{})}),e(u,{type:"change",onClick:()=>v(`edit/${i}`),children:e(d,{})})]})]}),p===n?e(w,{photoHandler:g,isOpen:p,item:{id:n,path:o}}):null,b&&n!=null&&A.posts?e(B,{setVisible:c,currentState:b,children:t("div",{className:"admin__delwindow",children:[t("p",{className:"admin__deltext",children:["Вы уверены, что хотите удалить картину “","”?"]}),t("div",{className:"admin__delbtns",children:[e("button",{className:"admin__delbtn",onClick:I,children:"Удалить"}),e("button",{className:"admin__cancelbtn",onClick:()=>c(!1),children:"Отмена"})]})]})}):null]})}function H(){const s=f(),a=N(),l=h(n=>n.posts);m.useEffect(()=>{a(O())},[]);const o=()=>s("create");return t("div",{className:"ac",children:[e("h1",{className:"admin__title",children:"Блог"}),e("div",{className:"admin__content ac__content",children:l.posts?e("ul",{className:"admin__list",children:l.posts.map((n,i)=>e(P.Fragment,{children:e(E,{...n,index:i})},i))}):null}),e(u,{onClick:o,children:"Создать пост"})]})}function F(){const s=h(a=>a.auth);return!s.userInfo&&s.loading?e("h1",{children:"Loading"}):s.isAdmin?t("div",{className:"admin",children:[e("div",{className:"admin__main-area",children:e(H,{})}),e(R,{})]}):e("h1",{children:"Вы не админ, доступ запрещён"})}export{F as default};
